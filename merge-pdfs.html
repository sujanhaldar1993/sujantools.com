<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merge PDFs - SujanTech</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- PDF-lib Library -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .upload-section {
            margin-bottom: 30px;
        }

        .drop-zone {
            border: 3px dashed #e1e8ed;
            border-radius: 15px;
            padding: 60px 20px;
            text-align: center;
            background: #fafbfc;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .drop-zone:hover {
            border-color: #4facfe;
            background: #f0f9ff;
        }

        .drop-zone.drag-over {
            border-color: #4facfe;
            background: #f0f9ff;
            transform: scale(1.02);
        }

        .drop-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            color: #4facfe;
        }

        .drop-text h3 {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 10px;
        }

        .drop-text p {
            color: #666;
            font-size: 1rem;
        }

        .select-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
            transition: transform 0.2s ease;
        }

        .select-btn:hover {
            transform: translateY(-2px);
        }

        .files-preview {
            display: none;
            margin: 30px 0;
        }

        .preview-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }

        .files-list {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: between;
            padding: 15px;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .file-info {
            display: flex;
            align-items: center;
            flex: 1;
            gap: 15px;
        }

        .file-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .file-details h4 {
            font-size: 1rem;
            color: #333;
            margin-bottom: 4px;
        }

        .file-details p {
            font-size: 0.9rem;
            color: #666;
        }

        .file-actions {
            display: flex;
            gap: 10px;
        }

        .move-btn, .remove-btn {
            background: none;
            border: 1px solid #e1e8ed;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .move-btn:hover {
            background: #f1f5f9;
        }

        .remove-btn:hover {
            background: #fef2f2;
            border-color: #fecaca;
            color: #dc2626;
        }

        .merge-options {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .options-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .option-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .option-group {
                grid-template-columns: 1fr;
            }
        }

        .option-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .merge-btn {
            width: 100%;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            display: none;
        }

        .merge-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.3);
        }

        .merge-btn.show {
            display: block;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            backdrop-filter: blur(10px);
        }

        .info-section {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .info-title {
            color: #1e40af;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .info-text {
            color: #1e3a8a;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .content {
                padding: 20px;
            }
            
            .back-btn {
                position: relative;
                top: 0;
                left: 0;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <button class="back-btn" onclick="goBack()">‚Üê Back to Home</button>
    
    <div class="container">
        <div class="header">
            <h1>üîó Merge PDFs</h1>
            <p>Combine multiple PDF files into a single document</p>
        </div>
        
        <div class="content">
            <div class="info-section">
                <div class="info-title">‚ÑπÔ∏è How it works:</div>
                <div class="info-text">
                    Select multiple PDF files to merge them into one document. You can reorder files by dragging them or using the move buttons. The merged PDF will maintain the quality of your original documents.
                </div>
            </div>
            
            <div class="upload-section">
                <div class="drop-zone" id="dropZone" onclick="document.getElementById('fileInput').click()">
                    <div class="drop-icon">üìé</div>
                    <div class="drop-text">
                        <h3>Drop your PDF files here</h3>
                        <p>Select multiple PDF files to merge</p>
                        <button class="select-btn">Choose PDF Files</button>
                    </div>
                </div>
                <input type="file" id="fileInput" style="display: none;" multiple accept=".pdf">
            </div>
            
            <div class="files-preview" id="filesPreview">
                <div class="preview-title">Selected PDFs (<span id="fileCount">0</span>) - Drag to reorder</div>
                <div class="files-list" id="filesList"></div>
            </div>
            
            <div class="merge-options">
                <div class="options-title">Merge Options</div>
                <div class="option-group">
                    <div class="option-item">
                        <input type="checkbox" id="addBookmarks" checked>
                        <label for="addBookmarks">Add bookmarks for each file</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="addTOC">
                        <label for="addTOC">Create table of contents</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="preserveLinks" checked>
                        <label for="preserveLinks">Preserve internal links</label>
                    </div>
                    <div class="option-item">
                        <input type="checkbox" id="addPageNumbers">
                        <label for="addPageNumbers">Add continuous page numbers</label>
                    </div>
                </div>
            </div>
            
            <button class="merge-btn" id="mergeBtn" onclick="mergePDFs()">
                üöÄ Merge PDFs
            </button>
        </div>
    </div>

    <script>
        let selectedFiles = [];
        
        function goBack() {
            window.location.href = 'index.html';
        }

        // Drag and drop functionality
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('drag-over');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('drag-over');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
            const files = Array.from(e.dataTransfer.files).filter(file => file.type === 'application/pdf');
            handleFiles(files);
        });

        fileInput.addEventListener('change', (e) => {
            handleFiles(Array.from(e.target.files));
        });

        function handleFiles(files) {
            selectedFiles = [...selectedFiles, ...files];
            displayFiles();
            updateMergeButton();
        }

        function displayFiles() {
            const filesList = document.getElementById('filesList');
            const filesPreview = document.getElementById('filesPreview');
            const fileCount = document.getElementById('fileCount');
            
            filesList.innerHTML = '';
            
            selectedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.draggable = true;
                fileItem.innerHTML = `
                    <div class="file-info">
                        <div class="file-icon">PDF</div>
                        <div class="file-details">
                            <h4>${file.name}</h4>
                            <p>${(file.size / (1024 * 1024)).toFixed(2)} MB</p>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="move-btn" onclick="moveFileUp(${index})">‚Üë</button>
                        <button class="move-btn" onclick="moveFileDown(${index})">‚Üì</button>
                        <button class="remove-btn" onclick="removeFile(${index})">√ó</button>
                    </div>
                `;
                
                // Add drag functionality
                fileItem.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', index);
                    fileItem.style.opacity = '0.5';
                });
                
                fileItem.addEventListener('dragend', () => {
                    fileItem.style.opacity = '1';
                });
                
                fileItem.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    fileItem.style.background = '#f0f9ff';
                });
                
                fileItem.addEventListener('dragleave', () => {
                    fileItem.style.background = 'white';
                });
                
                fileItem.addEventListener('drop', (e) => {
                    e.preventDefault();
                    fileItem.style.background = 'white';
                    const draggedIndex = parseInt(e.dataTransfer.getData('text/plain'));
                    const targetIndex = index;
                    
                    if (draggedIndex !== targetIndex) {
                        const draggedFile = selectedFiles.splice(draggedIndex, 1)[0];
                        selectedFiles.splice(targetIndex, 0, draggedFile);
                        displayFiles();
                    }
                });
                
                filesList.appendChild(fileItem);
            });
            
            fileCount.textContent = selectedFiles.length;
            filesPreview.style.display = selectedFiles.length > 0 ? 'block' : 'none';
        }

        function moveFileUp(index) {
            if (index > 0) {
                [selectedFiles[index], selectedFiles[index - 1]] = [selectedFiles[index - 1], selectedFiles[index]];
                displayFiles();
            }
        }

        function moveFileDown(index) {
            if (index < selectedFiles.length - 1) {
                [selectedFiles[index], selectedFiles[index + 1]] = [selectedFiles[index + 1], selectedFiles[index]];
                displayFiles();
            }
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            displayFiles();
            updateMergeButton();
        }

        function updateMergeButton() {
            const mergeBtn = document.getElementById('mergeBtn');
            if (selectedFiles.length >= 2) {
                mergeBtn.classList.add('show');
            } else {
                mergeBtn.classList.remove('show');
            }
        }

        async function mergePDFs() {
            if (selectedFiles.length < 2) {
                alert('Please select at least 2 PDF files to merge!');
                return;
            }

            const mergeBtn = document.getElementById('mergeBtn');
            mergeBtn.textContent = 'üîÑ Merging PDFs...';
            mergeBtn.disabled = true;

            try {
                // Create a new PDFDocument
                const mergedPdf = await PDFLib.PDFDocument.create();
                
                // Process each selected file
                for (let i = 0; i < selectedFiles.length; i++) {
                    const file = selectedFiles[i];
                    
                    // Convert file to array buffer
                    const arrayBuffer = await file.arrayBuffer();
                    
                    // Load the PDF
                    const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                    
                    // Get all pages from the PDF
                    const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                    
                    // Add each page to the merged PDF
                    pages.forEach((page) => mergedPdf.addPage(page));
                }
                
                // Serialize the merged PDF
                const pdfBytes = await mergedPdf.save();
                
                // Create download link
                const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `merged-document-${new Date().toISOString().split('T')[0]}.pdf`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert(`‚úÖ Successfully merged ${selectedFiles.length} PDF files!`);
                
            } catch (error) {
                console.error('Error merging PDFs:', error);
                alert('‚ùå Error merging PDFs. Please ensure all files are valid PDF documents.');
            } finally {
                mergeBtn.textContent = 'üöÄ Merge PDFs';
                mergeBtn.disabled = false;
            }
        }
    </script>
</body>
</html>